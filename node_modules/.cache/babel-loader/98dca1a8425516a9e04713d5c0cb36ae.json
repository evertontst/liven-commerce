{"ast":null,"code":"import _asyncToGenerator from\"/Users/evertonluis/jobs/liven-commerce/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/evertonluis/jobs/liven-commerce/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/evertonluis/jobs/liven-commerce/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/evertonluis/jobs/liven-commerce/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/evertonluis/jobs/liven-commerce/node_modules/@babel/runtime/regenerator/index.js\";import{useState,useEffect}from'react';import{MdAddShoppingCart}from'react-icons/md';import{ProductList}from'./styles';import{api}from'../../services/api';import{priceBRL}from'../../util/format';import{useCart}from'../../hooks/useCart';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),products=_useState2[0],setProducts=_useState2[1];var _useCart=useCart(),addProduct=_useCart.addProduct,cart=_useCart.cart;var cartItemsAmount=cart.reduce(function(sumAmount,product){return sumAmount=_objectSpread(_objectSpread({},sumAmount),{},_defineProperty({},product.id,product.amount));},{});useEffect(function(){function loadProducts(){return _loadProducts.apply(this,arguments);}function _loadProducts(){_loadProducts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return api.get('products');case 2:response=_context.sent;data=response.data.map(function(product){return _objectSpread(_objectSpread({},product),{},{priceFormatted:priceBRL(product.price)});});setProducts(data);case 5:case\"end\":return _context.stop();}}},_callee);}));return _loadProducts.apply(this,arguments);}loadProducts();},[]);function handleAddProduct(id){addProduct(id);}return/*#__PURE__*/_jsx(ProductList,{children:products.map(function(product){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"img\",{src:product.image,alt:product.title}),/*#__PURE__*/_jsx(\"strong\",{children:product.title}),/*#__PURE__*/_jsx(\"span\",{children:product.priceFormatted}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",\"data-testid\":\"add-product-button\",onClick:function onClick(){return handleAddProduct(product.id);},children:[/*#__PURE__*/_jsxs(\"div\",{\"data-testid\":\"cart-product-quantity\",children:[/*#__PURE__*/_jsx(MdAddShoppingCart,{size:16,color:\"#FFF\"}),cartItemsAmount[product.id]||0]}),/*#__PURE__*/_jsx(\"span\",{children:\"ADICIONAR AO CARRINHO\"})]})]},product.id);})});};export default Home;","map":{"version":3,"names":["useState","useEffect","MdAddShoppingCart","ProductList","api","priceBRL","useCart","Home","products","setProducts","addProduct","cart","cartItemsAmount","reduce","sumAmount","product","id","amount","loadProducts","get","response","data","map","priceFormatted","price","handleAddProduct","image","title"],"sources":["/Users/evertonluis/jobs/liven-commerce/src/pages/Home/index.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { MdAddShoppingCart } from 'react-icons/md';\n\nimport { ProductList } from './styles';\nimport { api } from '../../services/api';\nimport { priceBRL } from '../../util/format';\nimport { useCart } from '../../hooks/useCart';\n\ninterface Product {\n  id: number;\n  title: string;\n  price: number;\n  image: string;\n}\n\ninterface ProductFormatted extends Product {\n  priceFormatted: string;\n}\n\ninterface CartItemsAmount {\n  [key: number]: number;\n}\n\nconst Home = (): JSX.Element => {\n  const [products, setProducts] = useState<ProductFormatted[]>([]);\n  const { addProduct, cart } = useCart();\n\n  \n  const cartItemsAmount = cart.reduce((sumAmount, product) => {\n    return sumAmount = {\n      ...sumAmount,\n      [product.id]: product.amount\n    }\n  }, {} as CartItemsAmount)\n\n  useEffect(() => {\n    async function loadProducts() {\n      const response = await api.get<Product[]>('products');\n\n      const data = response.data.map(product => ({\n        ...product,\n        priceFormatted: priceBRL(product.price)\n      }))\n      setProducts(data);\n    }\n\n    loadProducts();\n  }, []);\n\n  function handleAddProduct(id: number) {\n    addProduct(id);\n  }\n\n  return (\n    <ProductList>\n      {products.map(product => {\n        return (\n          <li key={product.id} >\n            <img src={product.image} alt={product.title} />\n            <strong>{product.title}</strong>\n            <span>{product.priceFormatted}</span>\n            <button\n              type=\"button\"\n              data-testid=\"add-product-button\"\n            onClick={() => handleAddProduct(product.id)}\n            >\n              <div data-testid=\"cart-product-quantity\">\n                <MdAddShoppingCart size={16} color=\"#FFF\" />\n                {cartItemsAmount[product.id] || 0}\n              </div>\n\n              <span>ADICIONAR AO CARRINHO</span>\n            </button>\n          </li>\n        )\n      })}\n    </ProductList>\n  );\n};\n\nexport default Home;\n"],"mappings":"gnBAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,OAASC,iBAAT,KAAkC,gBAAlC,CAEA,OAASC,WAAT,KAA4B,UAA5B,CACA,OAASC,GAAT,KAAoB,oBAApB,CACA,OAASC,QAAT,KAAyB,mBAAzB,CACA,OAASC,OAAT,KAAwB,qBAAxB,C,wFAiBA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,EAAmB,CAC9B,cAAgCP,QAAQ,CAAqB,EAArB,CAAxC,wCAAOQ,QAAP,eAAiBC,WAAjB,eACA,aAA6BH,OAAO,EAApC,CAAQI,UAAR,UAAQA,UAAR,CAAoBC,IAApB,UAAoBA,IAApB,CAGA,GAAMC,CAAAA,eAAe,CAAGD,IAAI,CAACE,MAAL,CAAY,SAACC,SAAD,CAAYC,OAAZ,CAAwB,CAC1D,MAAOD,CAAAA,SAAS,gCACXA,SADW,wBAEbC,OAAO,CAACC,EAFK,CAEAD,OAAO,CAACE,MAFR,EAAhB,CAID,CALuB,CAKrB,EALqB,CAAxB,CAOAhB,SAAS,CAAC,UAAM,SACCiB,CAAAA,YADD,8IACd,2KACyBd,CAAAA,GAAG,CAACe,GAAJ,CAAmB,UAAnB,CADzB,QACQC,QADR,eAGQC,IAHR,CAGeD,QAAQ,CAACC,IAAT,CAAcC,GAAd,CAAkB,SAAAP,OAAO,wCACjCA,OADiC,MAEpCQ,cAAc,CAAElB,QAAQ,CAACU,OAAO,CAACS,KAAT,CAFY,IAAzB,CAHf,CAOEf,WAAW,CAACY,IAAD,CAAX,CAPF,sDADc,+CAWdH,YAAY,GACb,CAZQ,CAYN,EAZM,CAAT,CAcA,QAASO,CAAAA,gBAAT,CAA0BT,EAA1B,CAAsC,CACpCN,UAAU,CAACM,EAAD,CAAV,CACD,CAED,mBACE,KAAC,WAAD,WACGR,QAAQ,CAACc,GAAT,CAAa,SAAAP,OAAO,CAAI,CACvB,mBACE,mCACE,YAAK,GAAG,CAAEA,OAAO,CAACW,KAAlB,CAAyB,GAAG,CAAEX,OAAO,CAACY,KAAtC,EADF,cAEE,wBAASZ,OAAO,CAACY,KAAjB,EAFF,cAGE,sBAAOZ,OAAO,CAACQ,cAAf,EAHF,cAIE,gBACE,IAAI,CAAC,QADP,CAEE,cAAY,oBAFd,CAGA,OAAO,CAAE,yBAAME,CAAAA,gBAAgB,CAACV,OAAO,CAACC,EAAT,CAAtB,EAHT,wBAKE,aAAK,cAAY,uBAAjB,wBACE,KAAC,iBAAD,EAAmB,IAAI,CAAE,EAAzB,CAA6B,KAAK,CAAC,MAAnC,EADF,CAEGJ,eAAe,CAACG,OAAO,CAACC,EAAT,CAAf,EAA+B,CAFlC,GALF,cAUE,+CAVF,GAJF,GAASD,OAAO,CAACC,EAAjB,CADF,CAmBD,CApBA,CADH,EADF,CAyBD,CAvDD,CAyDA,cAAeT,CAAAA,IAAf"},"metadata":{},"sourceType":"module"}